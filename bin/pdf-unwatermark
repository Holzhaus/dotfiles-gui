#!/bin/sh
# Removes watermarks from PDF

if [ -z "$1" ] || [ -z "$2" ]
then
    printf 'Usage: %s INPUTFILE OUTPUTFILE [ WATERMARK_STRING ]' "$0"
fi

WATERMARK_STRING="Generated by CamScanner"
[ ! -z "$3" ] && WATERMARK_STRING="$3"

TEMPFILE="$(mktemp --suffix=".pdf")"
trap 'rm -f "$TEMPFILE"' EXIT

pdftk "$1" output "$TEMPFILE" uncompress
sed -i "s|$WATERMARK_STRING||g" "$TEMPFILE"
pdftk "$TEMPFILE" output "$2" compress
